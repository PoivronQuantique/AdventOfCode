
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;

namespace AdventOfCode.Jours
{
    public class Jour_11 : Jour_abs
    {
        #region Enumerables
        #endregion

        #region Propriétés
        private Universe Univers { get; set; }
        #endregion

        #region Constructeur
        public Jour_11(bool debug = false):base(debug)
        {
            #region Input Data
            string InputData = "...................#.....#...............#......................#......................#...................#...........................#....\r\n..................................................#................................................#..............#.........................\r\n......#.....#.................#..............................................................#..............................................\r\n......................................................#..................#.....#............................................................\r\n.....................................................................................#.....................................#................\r\n.#............................................................................................................#.............................\r\n..................#......................#............................#..............................................................#.....#\r\n......................................................................................................#.............#.......................\r\n..............................................#........#........................#................................................#..........\r\n.....#......................#......................................#.....#...................#..............................................\r\n.........................................................................................................#..................................\r\n......................#...............#............#........................................................................................\r\n..................................................................................................#.........................................\r\n..........#..................................................................................................#..............#..........#....\r\n....#...........................#..........................#..............................#.................................................\r\n........................................#............................................#.................................#.........#..........\r\n...................................................................#...........#..........................#.................................\r\n............................................................................................................................................\r\n............................................#...............................................................................................\r\n....................#.................................#................................................................................#....\r\n............................................................................................#...............................................\r\n............................................................................#........#.........................................#............\r\n...#...................#..........................#...............#......................................................#..................\r\n..............................#........#....................................................................................................\r\n................#................................................................................#.......................................#..\r\n......#..............................................................#...................#..................................................\r\n.#.........................................#..........#.........#..............#........................#............#......................\r\n............................................................................................................................................\r\n...........#...................................#...............................................................#.............#..............\r\n........................#........#........................................#..........#..................................................#...\r\n....#.....................................................#.................................#......................................#........\r\n...............................................................#...................................#....................#...................\r\n#.............................................................................#..................................#.............#............\r\n.............................#..........#.............................#...................................#.................................\r\n........................................................#...................................................................................\r\n.............#........................................................................................................#................#....\r\n...#.............................................#..................................#......#.....#..........................................\r\n................................#..............................#............................................................................\r\n...................#........................................................#...............................................................\r\n#..........................#.........................................................................#......#...........#...................\r\n.......#...........................#.....#..............#.................................................................................#.\r\n......................#.........................#...........................................................................................\r\n.....................................................................................................................#.......#......#.......\r\n.............................................................#....................#...............#.........................................\r\n.........#..................................................................................................................................\r\n...............................#............#....................#.....#...............#..................#.................................\r\n....#...........#.........#.........................#..............................................................#..................#.....\r\n.....................#.......................................................................#..............................................\r\n....................................................................................................#.......................................\r\n.....................................#..........#...............................#...........................#..........#..........#.......#.\r\n..........................................................................................#.................................................\r\n.#..........................................#.............................#.................................................................\r\n.................#...........#............................#.............................................#......................#............\r\n.........#...........................................................#..............#.......................................................\r\n..................................................................................................#.............#.......#...................\r\n.............................................................................#.......................................................#......\r\n......#.............#...........#..........#........#...........#...........................................#...............................\r\n.........................................................................#..................................................................\r\n........................................................#...........#...........#................................................#..........\r\n........................................#....................#..........................................#.............#.....................\r\n..........#...................#................................................................#..........................................#.\r\n..................#.................................................................................#..........#............................\r\n..........................................................................................#.................................................\r\n..........................................................#...............#.................................................................\r\n............#................................#......................#..........#.........................................#......#...........\r\n..#.......................#..................................................................................#.....#........................\r\n.................................................#...........................................#..............................................\r\n.........#........#..................#...........................#.....................#...............#.............................#......\r\n......................................................................#..........................#.....................#....................\r\n............................................................................................................................................\r\n........................#.....................................................................................#............#............#...\r\n..............#............................#.................................#......#.......................................................\r\n........#..........#........................................................................................................................\r\n............................#............................................#..........................#.......................................\r\n.......................................................#......#.........................................................#......#............\r\n.........................................................................................#.....#..................#.........................\r\n.......................#................#.......................................#............................#.......................#......\r\n............................................................................................................................................\r\n.........#.......................................................................................................................#..........\r\n...#..........#................................#...........#......#.....................................................................#...\r\n....................................................................................#.......................................................\r\n.............................#.....................................................................................#.....#..................\r\n...................................#.....................................................#.............#....................................\r\n.....#.............#................................#......................................................................................#\r\n.............#............................................#...................#.................#.....................#.....#......#........\r\n#...............................#.........#..........................................#......................................................\r\n.........................#...............................................#..................................................................\r\n.................................................................................#......................................................#...\r\n....#...........#..................................#......................................................#.................................\r\n..............................................#.....................#.......................#...........................#...................\r\n..............................#.........................#.............................................#.........#...........................\r\n.........................................#.....................................#...............................................#............\r\n.#.........#..................................................#..........................#...........................#......................\r\n............................................................................................................................................\r\n.........................................................................................................................................#..\r\n.......#..........................................#.......................#................................................#........#.......\r\n............................................................................................................................................\r\n.................#.........#.........................................#.........................#.....#......#...............................\r\n............................................#..........#......................#......#......................................................\r\n....................................#.............................................................................#.........................\r\n...........................................................#................................................................................\r\n.................................................................................#........#...............#..............................#..\r\n.......#...........#..............................#.........................................................................................\r\n..#...............................................................................................#.................#............#..........\r\n..............................................#..........#...............#..................................................................\r\n..................................#.....#.....................#.......................#...............#......#.............#................\r\n..........................#.................................................................................................................\r\n....................................................#..................................................................#....................\r\n...........................................................................#..............#.....#...........................................\r\n#...................#...........................................................#...........................................................\r\n...........................................#....................#....................................................................#......\r\n.......#.....#........................................#....................................................#................................\r\n..............................#...................................................................#.........................................\r\n.............................................................................#.......................................#......................\r\n.....................#....................................................................................................................#.\r\n.................................#....................................#........................#............................................\r\n......#...........................................#.........................................................................................\r\n...........................................#................................................................................#......#........\r\n..........#...............#.........................................................#.......................................................\r\n..................#...........................................................#.............................................................\r\n...............................................................#............................................#.......#.......................\r\n....#........#...................................................................................#..........................................\r\n......................#...................................................#...........#................#....................................\r\n........#..............................................#...................................#....................#...........................\r\n..................................................#.......................................................................#..........#......\r\n.#...................................#..........................................................................................#...........\r\n..........................................#........................................#...............#........................................\r\n..........................#.....#........................................................................................................#..\r\n..................#...........................#..........#...........................................................#......................\r\n...................................................#......................#...................................................#.............\r\n.........#................................................................................#.................................................\r\n..............#................................................................#............................................................\r\n...........................#.........#..............................#...................................#..........#....................#...\r\n..................................................................................................#.............................#...........\r\n..#..............................................#..........................................................................................\r\n.................#.....................................................#.................#..................................................\r\n.................................#.........#...................................................#......#.........#...........................\r\n..........#.........................................#.....#......................#..........................................................\r\n....................#..........................#................#...........................................................#......#........\r\n#........................#.............#..................................#.................................#...............................";
            //InputData = "";   // Exemple donné pour debug
            #endregion

            InitInputData(InputData);

            Univers = new Universe(Lines);

            if (this.Debug)
                DebugInit();
        }
        #endregion

        #region Initialisation
        #endregion

        #region Méthodes publiques
        public override long Partie1()
        {
            return ProcessPart1();
        }

        public override long Partie2()
        {
            return ProcessPart2();
        }
        #endregion

        #region Process
        private long ProcessPart1()
        {
            return Univers.GetPaires().Sum(p=>p.ShortestPath);
        }
        private long ProcessPart2()
        {
            return Univers.GetPaires().Sum(p => p.ShortestPath2);
        }
        #endregion

        #region Debug
        private void DebugInit()
        {
        }
        #endregion

        #region Classes de travail
        private class Universe : List<Zone> 
        {
            public Universe(List<string> inputData)
            {
                bool[] horizontalGalax = new bool[inputData[0].Length];
                bool[] verticalGalax = new bool[inputData.Count];
                long Num = 1;
                for(int i = 0; i < inputData.Count; i++)
                {
                    for(int j = 0; j < inputData[i].Length; j++)
                    {
                        if (inputData[i][j] == '#')
                        {
                            verticalGalax[i] = true;
                            horizontalGalax[j] = true;
                            this.Add(new Zone(j,i));
                            Num++;
                        }
                    }
                }
                for (int i = horizontalGalax.Length - 1; i >= 0; i--)
                {
                    if (!horizontalGalax[i])
                    {
                        this.Where(z => z.X > i).ToList().ForEach(z => { z.X++; z.X2 += 999999; });
                    }
                }
                for (int i = verticalGalax.Length - 1; i >= 0; i--)
                {
                    if (!verticalGalax[i])
                    {
                        this.Where(z => z.Y > i).ToList().ForEach(z => { z.Y++; z.Y2 += 999999; });
                    }
                }
            }

            public List<PairOfZones> GetPaires()
            {
                List<PairOfZones> Paires = new List<PairOfZones>();
                for(int i = 0; i < this.Count-1; i++)
                {
                    for(int j = i+1; j < this.Count; j++)
                    {
                        Paires.Add(new PairOfZones(this[i], this[j]));
                    }
                }

                return Paires;
            }
        }
        private class Zone
        {
            private static long Counter = 0;
            public long X { get; set; }
            public long Y { get; set; }
            public long X2 { get; set; }
            public long Y2 { get; set; }
            public long IdNumber { get; set; }
            private Zone() { }
            public Zone(long X, long y)
            {
                Counter++;
                this.X = X;
                this.Y = y;
                this.X2 = X;
                this.Y2 = y;
                this.IdNumber = Counter;
            }
        }

        private class PairOfZones
        {
            public Zone zone1 { get; set; }
            public Zone zone2 { get; set; }
            public long ShortestPath { get; private set; }
            public long ShortestPath2 { get; private set; }
            private PairOfZones() { }
            public PairOfZones(Zone zone1, Zone zone2)
            {
                this.zone1 = zone1;
                this.zone2 = zone2;
                ShortestPath = Math.Abs(zone2.X - zone1.X) + Math.Abs(zone2.Y - zone1.Y);
                ShortestPath2 = Math.Abs(zone2.X2 - zone1.X2) + Math.Abs(zone2.Y2 - zone1.Y2);
            }
        }
        #endregion
    }
}
